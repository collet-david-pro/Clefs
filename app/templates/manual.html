<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page_title }} - Gestionnaire de Clés</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    {% include 'navbar.html' %}

    <main class="container" style="padding-top: 5rem;">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>{{ page_title }}</h1>
        </div>

        <div class="accordion" id="manualAccordion">

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        Étape 1 : Configurer l'environnement
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#manualAccordion">
                    <div class="accordion-body">
                        <p>La première chose à faire est de définir la structure de votre établissement.</p>
                        <ol>
                            <li>Cliquez sur l'onglet <strong>Configuration</strong> pour accéder au panneau d'administration.</li>
                            <li><strong>Créez vos Emprunteurs :</strong> Allez dans "Gérer les Emprunteurs" pour ajouter les personnes qui pourront emprunter des clés.</li>
                            <li><strong>Créez vos Bâtiments :</strong> Allez dans "Gérer les Bâtiments" et ajoutez les bâtiments que vous souhaitez gérer.</li>
                            <li><strong>Créez vos Points d'Accès :</strong> Allez dans "Gérer les Points d'Accès" pour ajouter les salles, portes, etc., en les liant à un bâtiment.</li>
                        </ol>
                        <p>Une fois ces étapes terminées, vous disposez d'une base de données prête pour la gestion des clés.</p>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        Étape 2 : Ajouter et Gérer les Clés
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#manualAccordion">
                    <div class="accordion-body">
                        <p>Maintenant que vos points d'accès sont créés, vous pouvez ajouter les clés correspondantes.</p>
                        <ol>
                            <li>Depuis la page <strong>Configuration</strong>, cliquez sur "Gérer les Clés".</li>
                            <li>Remplissez le formulaire "Ajouter un type de clé" :</li>
                            <ul>
                                <li><strong>Numéro / Identifiant :</strong> Un nom unique pour ce type de clé (ex: PGP-A pour Passe Général Partiel Bâtiment A).</li>
                                <li><strong>Description :</strong> Une description claire de son usage.</li>
                                <li><strong>Nombre total de clés :</strong> Indiquez le nombre total de clés de ce type en votre possession (ex: 5 clés).</li>
                                <li><strong>Nombre de clés en réserve :</strong> Indiquez combien de clés vous souhaitez garder en réserve, c'est-à-dire non disponibles au prêt (ex: 1 clé en réserve). Le système calculera automatiquement les clés disponibles au prêt : <em>Disponibles = Total - Réserve</em>.</li>
                                <li><strong>Lieu de Stockage :</strong> Indiquez où ces clés sont physiquement rangées (ex: Accueil, Armoire 5...).</li>
                                <li><strong>Points d'accès autorisés :</strong> C'est l'étape la plus importante. Cochez dans la liste toutes les salles et portes que cette clé est autorisée à ouvrir.</li>
                            </ul>
                            <li>Cliquez sur "Ajouter la Clé".</li>
                            <li>Pour modifier une clé, cliquez sur le bouton <strong>Éditer</strong> dans la liste.</li>
                        </ol>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        Étape 3 : Gérer les Emprunts et Retours
                    </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#manualAccordion">
                    <div class="accordion-body">
                        <h5>Pour emprunter une ou plusieurs clés :</h5>
                        <ol>
                            <li>Allez sur le <strong>Tableau de Bord</strong> et cliquez sur "Nouvel Emprunt".</li>
                            <li>Dans le formulaire, sélectionnez l'emprunteur.</li>
                            <li><strong>Cochez les cases</strong> correspondant à la ou les clé(s) à emprunter dans la liste.</li>
                            <li>Validez. Si une seule clé est empruntée, un PDF est généré. Sinon, vous retournez au tableau de bord.</li>
                        </ol>
                        <hr>
                        <h5>Pour retourner une clé :</h5>
                        <ol>
                            <li>Allez sur le <strong>Tableau de Bord</strong> ou dans l'onglet <strong>Emprunts en Cours</strong>.</li>
                            <li>Cliquez sur le bouton "Retourner" correspondant au type de clé que vous souhaitez enregistrer.</li>
                            <li>Si plusieurs personnes ont ce type de clé, une page vous demandera de sélectionner l'emprunt exact à clôturer. Cliquez sur "Confirmer le Retour".</li>
                        </ol>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingFour">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                        Générer des PDF (Individuels et Groupés)
                    </button>
                </h2>
                <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#manualAccordion">
                    <div class="accordion-body">
                        <h5>PDF Individuel (par emprunt) :</h5>
                        <ul>
                            <li>Lors d'un nouvel emprunt d'une seule clé, un PDF est automatiquement généré.</li>
                            <li>Vous pouvez aussi réimprimer un PDF individuel depuis le <strong>Tableau de Bord</strong> ou <strong>Emprunts en Cours</strong> en cliquant sur l'icône PDF à côté de chaque emprunt.</li>
                        </ul>
                        <hr>
                        <h5>PDF Groupé (toutes les clés d'une personne) :</h5>
                        <p>Cette fonctionnalité est idéale pour faire signer un seul document à une personne qui a emprunté plusieurs clés.</p>
                        <ol>
                            <li><strong>Depuis la page "Gérer les Emprunteurs" :</strong>
                                <ul>
                                    <li>Dans la colonne "Clés Empruntées", vous voyez le nombre de clés que chaque personne a actuellement.</li>
                                    <li>Si une personne a des clés, un bouton <strong>PDF</strong> vert apparaît.</li>
                                    <li>Cliquez dessus pour générer un document unique avec toutes ses clés.</li>
                                </ul>
                            </li>
                            <li><strong>Depuis la page "Emprunts en Cours" :</strong>
                                <ul>
                                    <li>Chaque carte d'emprunteur affiche un bouton <strong>PDF Groupé</strong> dans l'en-tête.</li>
                                    <li>Cliquez dessus pour générer le PDF de toutes les clés de cette personne.</li>
                                </ul>
                            </li>
                        </ol>
                        <p><strong>Contenu du PDF groupé :</strong></p>
                        <ul>
                            <li>Nom de l'emprunteur et date de génération</li>
                            <li>Nombre total de clés empruntées</li>
                            <li>Liste numérotée de toutes les clés avec leurs dates d'emprunt</li>
                            <li>Texte d'engagement à signer</li>
                            <li>Ligne de signature</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingFive">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                        Consulter les Plans et les Emprunts
                    </button>
                </h2>
                <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#manualAccordion">
                    <div class="accordion-body">
                        <ul>
                            <li><strong>Plan de Clés :</strong> Cet onglet vous offre une vue matricielle. Utilisez les onglets "Vue par Clé" ou "Vue par Point d'Accès" pour répondre rapidement aux questions "Qui ouvre quoi ?" et "Qu'est-ce qui ouvre ici ?".</li>
                            <li><strong>Emprunts en Cours :</strong> Cet onglet vous montre, <strong>groupé par personne</strong>, qui a quelles clés en ce moment. C'est l'outil idéal pour un suivi rapide et pour réimprimer un bon de sortie (individuel ou groupé) si nécessaire.</li>
                            <li><strong>Rapport des Clés :</strong> Nouvel onglet offrant une vue d'ensemble complète de toutes les clés actuellement sorties.
                                <ul>
                                    <li><strong>Tableau principal :</strong> Liste toutes les clés empruntées avec : numéro de clé, description, nom de l'emprunteur, date d'emprunt, et durée.</li>
                                    <li><strong>Indicateurs de durée :</strong> Code couleur pour identifier rapidement les emprunts :
                                        <ul>
                                            <li><span class="badge bg-success">Vert</span> : Emprunté aujourd'hui</li>
                                            <li><span class="badge bg-info">Bleu</span> : 1 à 6 jours</li>
                                            <li><span class="badge bg-warning">Jaune</span> : 7 à 29 jours</li>
                                            <li><span class="badge bg-danger">Rouge</span> : 30 jours ou plus</li>
                                        </ul>
                                    </li>
                                    <li><strong>Résumé par emprunteur :</strong> Section affichant le nombre de clés par personne avec la liste des numéros de clés.</li>
                                    <li><strong>Export PDF :</strong> Bouton "Imprimer / PDF" pour exporter le rapport complet (idéal pour archivage ou présentation).</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
